
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/auto_examples/analysis/plot_simplisma.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_auto_examples_analysis_plot_simplisma.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_auto_examples_analysis_plot_simplisma.py:


SIMPLISMA example
-----------------
In this example, we perform the PCA dimensionality reduction of a spectra
dataset

.. GENERATED FROM PYTHON SOURCE LINES 16-17

Import the spectrochempy API package (and the SIMPLISMA model independently)

.. GENERATED FROM PYTHON SOURCE LINES 17-19

.. code-block:: default

    import spectrochempy as scp








.. GENERATED FROM PYTHON SOURCE LINES 20-21

Load a matlab datasets

.. GENERATED FROM PYTHON SOURCE LINES 21-29

.. code-block:: default

    print("Dataset (Jaumot et al., Chemometr. Intell. Lab. 76 (2005) 101-110)):")
    lnd = scp.read_matlab("matlabdata/als2004dataset.MAT", merge=False)
    for mat in lnd:
        print("    " + mat.name, str(mat.shape))

    ds = lnd[-1]
    _ = ds.plot()




.. image-sg:: /gallery/auto_examples/analysis/images/sphx_glr_plot_simplisma_001.png
   :alt: plot simplisma
   :srcset: /gallery/auto_examples/analysis/images/sphx_glr_plot_simplisma_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Dataset (Jaumot et al., Chemometr. Intell. Lab. 76 (2005) 101-110)):
        cpure (204, 4)
        MATRIX (204, 96)
        isp_matrix (4, 4)
        spure (4, 96)
        csel_matrix (51, 4)
        m1 (51, 96)




.. GENERATED FROM PYTHON SOURCE LINES 30-31

Add some metadata for a nicer display

.. GENERATED FROM PYTHON SOURCE LINES 31-39

.. code-block:: default

    ds.title = "absorbance"
    ds.units = "absorbance"
    ds.set_coordset(None, None)
    ds.y.title = "elution time"
    ds.x.title = "wavelength"
    ds.y.units = "hours"
    ds.x.units = "nm"








.. GENERATED FROM PYTHON SOURCE LINES 40-41

Fit the SIMPLISMA model

.. GENERATED FROM PYTHON SOURCE LINES 41-45

.. code-block:: default

    print("Fit SIMPLISMA on {}\n".format(ds.name))
    simpl = scp.SIMPLISMA(max_components=20, tol=0.2, noise=3, log_level="INFO")
    simpl.fit(ds)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Fit SIMPLISMA on m1

    /home/runner/micromamba-root/envs/scpy/lib/python3.9/site-packages/spectrochempy/utils/decorators.py:85: DeprecationWarning:  The `max_components` attribute is now deprecated. Use `n_components` instead. `max_components` attribute will be removed in version 0.7. 
      warn(
    /home/runner/micromamba-root/envs/scpy/lib/python3.9/site-packages/spectrochempy/analysis/simplisma.py:190: UserWarning: SIMPLISMA does not handle easily negative values.
      warn("SIMPLISMA does not handle easily negative values.")

    <spectrochempy.analysis.simplisma.SIMPLISMA object at 0x7f15af9543d0>



.. GENERATED FROM PYTHON SOURCE LINES 46-47

Plot concentration

.. GENERATED FROM PYTHON SOURCE LINES 47-49

.. code-block:: default

    _ = simpl.C.T.plot(title="Concentration")




.. image-sg:: /gallery/auto_examples/analysis/images/sphx_glr_plot_simplisma_002.png
   :alt: Concentration
   :srcset: /gallery/auto_examples/analysis/images/sphx_glr_plot_simplisma_002.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 50-51

Plot components (St)

.. GENERATED FROM PYTHON SOURCE LINES 51-56

.. code-block:: default


    # sphinx_gallery_thumbnail_number = 3

    _ = simpl.components.plot(title="Pure profiles")




.. image-sg:: /gallery/auto_examples/analysis/images/sphx_glr_plot_simplisma_003.png
   :alt: Pure profiles
   :srcset: /gallery/auto_examples/analysis/images/sphx_glr_plot_simplisma_003.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 57-59

Show the plot of merit
after reconstruction oto the original data space

.. GENERATED FROM PYTHON SOURCE LINES 59-61

.. code-block:: default

    simpl.plotmerit(offset=0, nb_traces=5)




.. image-sg:: /gallery/auto_examples/analysis/images/sphx_glr_plot_simplisma_004.png
   :alt: SIMPLISMA plot of merit
   :srcset: /gallery/auto_examples/analysis/images/sphx_glr_plot_simplisma_004.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <_Axes: title={'center': 'SIMPLISMA plot of merit'}, xlabel='values $\\mathrm{}$', ylabel='absorbance $\\mathrm{/\\ \\mathrm{a.u.}}$'>



.. GENERATED FROM PYTHON SOURCE LINES 62-64

This ends the example ! The following line can be uncommented if no plot shows when
running the .py script

.. GENERATED FROM PYTHON SOURCE LINES 66-68

.. code-block:: default


    # scp.show()








.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.887 seconds)


.. _sphx_glr_download_gallery_auto_examples_analysis_plot_simplisma.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_simplisma.py <plot_simplisma.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_simplisma.ipynb <plot_simplisma.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
