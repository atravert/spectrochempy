
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gettingstarted/gallery/auto_examples/fitting/plot_lstsq_single_equation.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gettingstarted_gallery_auto_examples_fitting_plot_lstsq_single_equation.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gettingstarted_gallery_auto_examples_fitting_plot_lstsq_single_equation.py:


Solve a linear equation using LSTSQ
===================================

In this example, we find the least  square solution of a simple linear
equation.

.. GENERATED FROM PYTHON SOURCE LINES 16-18

.. code-block:: default

    # sphinx_gallery_thumbnail_number = 2








.. GENERATED FROM PYTHON SOURCE LINES 19-21

.. code-block:: default

    import spectrochempy as scp








.. GENERATED FROM PYTHON SOURCE LINES 22-27

Let's take a similar example to the one given in the `numpy.linalg`
documentation

We have some noisy data that represent the distance `d` traveled by some
objects versus time `t`:

.. GENERATED FROM PYTHON SOURCE LINES 27-34

.. code-block:: default


    t = scp.NDDataset(data=[0, 1, 2, 3], title="time", units="hour")

    d = scp.NDDataset(
        data=[-1, 0.2, 0.9, 2.1], coordset=[t], title="distance", units="kilometer"
    )








.. GENERATED FROM PYTHON SOURCE LINES 35-36

Here is a plot of these data-points:

.. GENERATED FROM PYTHON SOURCE LINES 36-39

.. code-block:: default


    d.plot_scatter(markersize=7, mfc="red")




.. image-sg:: /gettingstarted/gallery/auto_examples/fitting/images/sphx_glr_plot_lstsq_single_equation_001.png
   :alt: plot lstsq single equation
   :srcset: /gettingstarted/gallery/auto_examples/fitting/images/sphx_glr_plot_lstsq_single_equation_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <_Axes: xlabel='time $\\mathrm{/\\ \\mathrm{h}}$', ylabel='distance $\\mathrm{/\\ \\mathrm{km}}$'>



.. GENERATED FROM PYTHON SOURCE LINES 40-50

We want to fit a line through these data-points of equation

.. math::

   d = v.t + d_0

By examining the coefficients, we see that the line should have a
gradient of roughly 1 km/h and cut the y-axis at, more or less, -1 km.

Using LSTSQ, the solution is found very easily:

.. GENERATED FROM PYTHON SOURCE LINES 50-56

.. code-block:: default


    lst = scp.LSTSQ(t, d)

    v, d0 = lst.transform()
    print("speed : {:.3fK},  d0 : {:.3fK}".format(v, d0))





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    speed : 1.000 kilometer.hour^-1,  d0 : -0.950 kilometer




.. GENERATED FROM PYTHON SOURCE LINES 57-58

Final plot

.. GENERATED FROM PYTHON SOURCE LINES 58-70

.. code-block:: default


    d.plot_scatter(
        markersize=10,
        mfc="red",
        mec="black",
        label="Original data",
        suptitle="Least-square fitting " "example",
    )
    dfit = lst.inverse_transform()

    dfit.plot_pen(clear=False, color="g", label="Fitted line", legend=True)




.. image-sg:: /gettingstarted/gallery/auto_examples/fitting/images/sphx_glr_plot_lstsq_single_equation_002.png
   :alt: plot lstsq single equation
   :srcset: /gettingstarted/gallery/auto_examples/fitting/images/sphx_glr_plot_lstsq_single_equation_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    <_Axes: xlabel='time $\\mathrm{/\\ \\mathrm{h}}$', ylabel='distance $\\mathrm{/\\ \\mathrm{km}}$'>



.. GENERATED FROM PYTHON SOURCE LINES 71-73

Note: The same result can be obtained directly using `d` as a single
parameter on LSTSQ (as `t` is the `x` coordinate axis!)

.. GENERATED FROM PYTHON SOURCE LINES 73-80

.. code-block:: default


    lst = scp.LSTSQ(d)

    v, d0 = lst.transform()
    print("speed : {:.3fK},  d0 : {:.3fK}".format(v, d0))

    # scp.show()  # uncomment to show plot if needed (not necessary in jupyter notebook)




.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    speed : 1.000 kilometer.hour^-1,  d0 : -0.950 kilometer





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.401 seconds)


.. _sphx_glr_download_gettingstarted_gallery_auto_examples_fitting_plot_lstsq_single_equation.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_lstsq_single_equation.py <plot_lstsq_single_equation.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_lstsq_single_equation.ipynb <plot_lstsq_single_equation.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
